---
title: 繪製wrfout地面氣流線
tags: NCL WRF
layout: article
aside:
  toc: true
sidebar:
  nav: layouts
date:  2022-08-11
modify_date: 2022-08-11 16:37:07
mermaid: true
---
## 背景
- 快速繪製地面氣流線，除了可以使用meteoinfo之外，似乎沒有好的方式。
  - 新版VERDI不再有vector的功能。
  - meteoinfo似乎不能直接開wrfout，還是需要ncks將數據取出
  - 如果解析度不是很高，也許可以轉成json檔，用[eth][eth]套件去開啟，也是一個不錯的方式。
- NCL的介紹與文件檔案連結，可以到[NCL Programs](https://sinotec2.github.io/Focus-on-Air-Quality/utilities/Graphics/NCL/) 去找。

## 執行批次
- 繪製流線圖至少需要wrfout的經緯度、時間標籤、以及U10/V10等變數。
- 環境變數NCAR_ROOT設定在執行檔前面，這是for crontab的執行方式，一般命令列也是可行執行。

```bash
for d in {0..4};do 
nc=wrfout_d01_2022-08-1${d}_00:00:00
  for i in 0;do 
    rm wrfout
    ncks -O -v Times,XLAT,XLONG,U10,V10,PBLH -d Time,$i $nc wrfout
    NCAR_ROOT=/opt/anaconda3/envs/ncl_stable /opt/anaconda3/envs/ncl_stable/bin/ncl ~/NCL_scripts/streamline/wrf_gsn_8.ncl
    mv wrf_gsn.png wrf_gsn${d}_$i.png
  done
done
```

## wrf_gsn_8.ncl修改說明
- 原始的程式可以參考[NCL官網wrfgsn](https://www.ncl.ucar.edu/Applications/wrfgsn.shtml)

```python

```