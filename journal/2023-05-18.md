# Thursday, May 18, 2023

## Forecasting using spatio-temporal data with combined Graph Convolution + LSTM model

[stellargraph.readthedocs.io](https://stellargraph.readthedocs.io/en/stable/demos/time-series/gcn-lstm-time-series.html)

To address these challenges, here we explore a neural network architecture that learns from both the **spatial road network data** and **time-series of historical speed changes** to forecast speeds on road segments at a future time. 
In the following we demo how to forecast speeds on road segments through a graph convolution and LSTM hybrid model. 
  - The spatial dependency of the road networks are learnt through **multiple graph convolution layers** stacked over **multiple LSTM**, sequence to sequence model, 
  - layers that leverage the historical speeds on top of the network structure to predicts speeds in the future for each entity.

## beginner’s guide

Published on January 26, 2022
In Mystery Vault
A beginner’s guide to Spatio-Temporal graph neural networks, [ Yugesh Verma(2022)](https://analyticsindiamag.com/a-beginners-guide-to-spatio-temporal-graph-neural-networks/)

## stallar jobs

### Node representation learning with Deep Graph Infomax

[cora with regression](https://stellargraph.readthedocs.io/en/stable/demos/embeddings/deep-graph-infomax-embeddings.html?highlight=REGRESSION)

```python
dir(dataset)='base_directory', 'data_directory', 'data_subdirectory_name', 'description', 'directory_name',
 'download', 'expected_files', 'load', 'name', 'source', 'url', 'url_archive_contains_directory', 'url_archive_format']

Gfcn=['check_graph_for_ml', 'connected_components', 'create_graph_schema', 'edge_arrays',
 'edge_feature_shapes', 'edge_feature_sizes', 'edge_features', 'edge_type_ilocs_to_names',
 'edge_type_names_to_ilocs', 'edge_types', 'edges', 'from_networkx', 'has_node',
 'in_node_arrays', 'in_nodes', 'info', 'is_directed', 'neighbor_arrays', 'neighbors',
 'node_degrees', 'node_feature_shapes', 'node_feature_sizes', 'node_features', 'node_ids_to_ilocs',
 'node_ilocs_to_ids', 'node_type', 'node_type_ilocs_to_names', 'node_type_names_to_ilocs',
 'node_types', 'nodes', 'nodes_of_type', 'number_of_edges', 'number_of_nodes', 'out_node_arrays',
 'out_nodes', 'subgraph', 'to_adjacency_matrix', 'to_networkx', 'unique_edge_type',
 'unique_node_type']
```

**stellargraph Graph not compatable with networkx**

![](../attachments/2023-05-18-11-25-03.png)

[lstm_layer_sizes](https://stackoverflow.com/questions/54903999/understanding-lstms-layers-data-dimensions)
  - 23 timeframe
  - 178 features
  - batch size is simple the number of samples (out of the 2900) that will be used for a training / test / prediction run.


```python
from keras.models import Sequential
from keras.layers import Dense, LSTM


model = Sequential()
model.add(LSTM(64, input_shape=(23,178)))
model.compile(loss='mse', optimizer='sgd')
model.summary()

print model.input
```

This is just a simplistic model that outputs a single **64**-wide vector for each sample. You will see that the expected model.input is:

```
Tensor("lstm_3_input:0", shape=(?, 23, 178), dtype=float32)
The batch_size is unset in the input shape which means that the model can be used to train / predict batches of different sizes.
```

[Source code for stellargraph.layer.gcn_lstm
]((https://stellargraph.readthedocs.io/en/latest/_modules/stellargraph/layer/gcn_lstm.html))
- gc_layer_sizes (list of int): Output sizes of Graph Convolution  layers in the stack.
- lstm_layer_sizes (list of int): Output sizes of LSTM layers in the stack.

